<!DOCTYPE HTML>
<html lang="en">
<head>
<title>RegCreateKey - Syntax &amp; Usage | AutoHotkey v2</title>
<meta name="description" content="The RegCreateKey function creates a registry key without writing a value." />
<meta name="ahk:equiv-v1" content="index.htm" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>RegCreateKey</h1>

<p>创建注册表键而不写入值.</p>

<pre class="Syntax"><span class="func">RegCreateKey</span> <span class="optional">KeyName</span></pre>
<h2 id="Parameters">参数</h2>
<dl>

  <dt>KeyName</dt>
  <dd>
    <p>类型: <a href="../Concepts.htm#strings">字符串</a></p>
    <p>注册表键的全名, 例如 <code>"HKLM\Software\SomeApplication"</code>.</p>
    <p>必须以 HKEY_LOCAL_MACHINE(或 HKLM), HKEY_USERS(或 HKU), HKEY_CURRENT_USER(或 HKCU), HKEY_CLASSES_ROOT(或 HKCR) 或 HKEY_CURRENT_CONFIG(或 HKCC) 开始.</p>
    <p>要访问<a href="#remote">远程注册表</a>, 请在前面加上计算机名和反斜杠, 例如 <code>"\\workstation01\HKLM"</code>.</p>
    <p><em>KeyName</em> 只有在<a href="LoopReg.htm">注册表循环</a>运行时才可以省略, 在这种情况下, 它默认为当前循环项的键(即使键在循环期间被删除). 如果项目是一个子键, 则默认使用该子键的全名.</p>
  </dd>

</dl>
<h2 id="Error_Handling">错误处理</h2>
<p>失败时抛出 <a href="Error.htm#OSError">OSError</a>.</p>
<p><a href="../Variables.htm#LastError">A_LastError</a> 被设置为操作系统的 GetLastError() 函数的结果.</p>

<h2 id="Remarks">备注</h2>
<p>如果 <em>KeyName</em> 指定了一个现有的注册表键, RegCreateKey 将验证脚本是否对该键具有写访问权, 但不会进行更改. 否则, RegCreateKey 将尝试创建该键(以及它的上级, 如果需要).</p>
<p>有关如何访问远程计算机的注册表, 请参阅<a href="LoopReg.htm#remote">注册表循环</a>中的备注.</p>
<p>要在 32 位脚本中在 64 位注册表中创建子键, 或反之, 请使用 <a href="SetRegView.htm">SetRegView</a>.</p>

<h2 id="Related">相关</h2>
<p><a href="RegDelete.htm">RegDelete</a>, <a href="RegDeleteKey.htm">RegDeleteKey</a>, <a href="RegRead.htm">RegRead</a>, <a href="RegWrite.htm">RegWrite</a>, <a href="LoopReg.htm">Registry-loop</a>, <a href="SetRegView.htm">SetRegView</a></p>

<h2 id="Examples">示例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> 创建一个空的注册表键. 如果安装了 Notepad2, 它的效果是将它添加到 .ahk 文件的 "打开方式" 菜单中.</p>
<pre>RegCreateKey "HKCU\Software\Classes\.ahk\OpenWithList\notepad2.exe"</pre>
</div>

</body>
</html>